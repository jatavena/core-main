# Vulnerability management
| | |
|:------: |:--: |
| Document | Vulnerability Management Framework for ECSP1 Project |
| Author:  | Jarmo Venäläinen (security) |
| Version: | v 1.0.1 |
|  Date:   |  21.1.2026 |
## Purpose of this document
The purpose of this document is to outline a vulnerability management framework for our OHTU 2025 e-commerce platform project. For learning purposes we were given a relatively old and unsecure version of PrestaShop to work with: 1.7.8.0. The main issue in this document is to deal with the massive amount of 4000 issues uncovered through our automated tests within CI/CD pipeline and also few uncovered through a PrestaShop module called PrestaScan. The issues were scanned from the 4 repositories that held the code and docker images for our platform and its database. PrestaScan operates from the PrestaShop instance back office.

More general security vulnerabilities such as policies regarding access etc., or the findings of other tools such as IriusRisk and Owasp ZAP, are not discussed here.
## What is vulnerability management?
Vulnerability management can be understood as an ongoing process that an organization uses to gain an understanding of its weaknesses through identification and analysis. This understanding is used to create a plan to address and manage these weaknesses. Purpose of planning ahead is to make the management proactive, systematic and transparent. Good vulnerability management practices not only improve the overall security of projects but is also important from the perspective of communicating and co-operating with stakeholders.
### Vulnerability management framework (VMF)
VMF describes the phases of the vulnerability management process and procedures at each step. the framework should also justify the set of actions described. This ensures transparency and possibility of critical engagement with the plan. 

As a part of our project we have enabled GitLab to do automated security scanning tools as a part of our CI/CD pipeline. These scans include:
- dependecy scanning,
- static application security testing (SAST),
- secret detection, and
- container scanning.
The scanners are configured to run only in repositories where they are assessed as useful.

In this context, the configuration and selection of what to scan is the first step in our framework. The second step in the framework is the actual scanning and identification of vulnerabilities. After the scanners have run and identified possible vulnerabilities the findings will go through a process of assessment which aims to first of all delineate real positives from false ones and also set a more detailed order of priority to the real vulnerabilities. The last phase in the overall process of vulnerability management is reporting and documenting the findings and actions taken upon them.

### Priority strategies
Part of our framework is a strategy to identify and prioritize the findings. This is needed for few reasons. First, there are simply too many findings to mitigate within the time given for this project. Second, not all the vulnerabilities or weaknesses are critical and/or immediately exploitable.

Regarding the first factor, it is crucial to give the findings a order of priority that makes sure, that the most acute threats are dealt first. This way the project makes sure, that the remaining vulnerabilities are not the ones that have the highest impact and most likely to be exploited. This is something that cannot be done, for example, simply by prioritizing vulnerabilities according to their GitLab threat levels; some critical threats don't actually have a known exploit and might have a very low EPSS score, while some high level threats have KEV and high EPSS score. Thus the latter cases should be prioritized even though they are not as "severe" as the former.

This leads us to the second point. Even if the project had more than enough time to mitigate all the vulnerabilities, the stakeholders may still want to allocate their resources to something else (eg. building and testing more features). This follows from the simple observation, that some of the vulnerabilities can simply be accepted as normal business risks and may not be worth the effort put in to mitigating them. Therefore it is important to have a clear and objective understanding and the ability to communicate to stakeholders, what is the impact of a given vulnerability and the probability of its exploitation against the system produced. Good VMF makes it possible to rationalize time saving decisions, and thus also contributes to the overall efficiency of the project.

# Applying the framework to DevLetics project
Before we can jump in to managing the findings with our framework, we need to understand them. This section explains the data, concepts and the models used.

## GitLab Severity Levels
GitLab vulnerability scanners try to give a standardized severity level tag for every vulnerability they find. The level are:
- `Critical`
- `High`
- `Medium`
- `Low`
- `Info`
- `Unknown`
These severity levels somewhat match determined range of CVSS v3.1 standard values indicating a threat level, that are derived through multiple metrics (see discussion below).
### Critical
Vulnerabilities estimated to be critical can lead to full system or data compromise. Examples of critical severity flaws are Command/Code Injection and SQL Injection. Typically these flaws are rated with CVSS 3.1 9.0-10.0.
### High
These vulnerabilities may lead to an unauthorized access of software resources and data exposure. Examples of high severity flaws are External XML Entity Injection (XXE), Server Side Request Forgery (SSRF), Local File Include/Path Traversal and certain forms of Cross-Site Scripting (XSS). CVSS range is 7.0-8.9.
### Medium
Exploits of medium level vulnerabilities may lead to an access to a limited amount of data or when combined with other vulnerabilities, access to systems or resources. Examples of medium severity flaws are reflected XSS, incorrect HTTP session handling, and missing security controls. Typically these flaws are rated with CVSS 3.1 between 4.0-6.9.
### Low
Low level vulnerabilities do not necessarily have a direct way of exploitation, but introduce unwanted weakness to a system. Examples of low severity vulnerabilities are missing cookie security directives, verbose error or exception messages. Typically these flaws are rated with CVSS 3.1 between 0.1-3.9.
### Info and Unknown severity
First of these contains some information, but is not necessarily associated with a particular weakness and typically don't have a CVSS rating. Unknown vulnerabilities are issues lacking enough context to clearly demonstrate severity.

## KEV Catalog
All the identified and officially cataloged vulnerabilities are not known to have be exploited in the real world. In contrast, the KEV (Known Exploited Vulnerability) catalog lists vulnerabilities that are known to have been exploited outside theoretical or laboratory environments. In the vulnerability reports inclusion of the vulnerability in KEV catalog is simply expressed with a yes or no. GitLab documentation recommends prioritizing vulnerabilities inculded in the KEV catalog above other vulnerabilities, even if they have lower severity level or CVSS-rating.
## EPSS-model
The EPSS model is used to find a numerical value on a scale of 0-1 (0-100%) for known vulnerabilities, which gives the probability of exploiting a specific vulnerability within the next 30 days. A higher numerical value indicates a higher probability of vulnerability exploitation. The numerical value is based on data collected from numerous sources about the actual exploitation of vulnerabilities in malicious activities. For this reason, it is also extremely important for the EPSS model to know _when_ vulnerability exploitation has been reported.

The number provided by the EPSS model does not in itself indicate the severity of the vulnerability to an information system; a vulnerability may have a high EPSS score, but still the impacts it enables may be minimal. For this reason, the EPSS model should be used as part of comprehensive assessments, at minimum together with the so-called CVSS score.

It is probably not possible to formulate an algorithmic answer to the question of how to prioritize mitigation of vulnerabilities, but in general lower severity vulnerabilities with significantly high EPSS scores may require mitigation sooner that high level vulnerabilities with a low EPSS score since they're more likely to be exploited. Never the less,  
## CVSS v3.1 - Common Vulnerability Scoring System
CVSS v3.1 is a standard for assessing threat severity. Threat severity is expressed as a numerical value between 1-10, where one is the lowest and 10 is the highest value for a threat. The numerical values are divided into qualitative categories as follows:

|Severity|Severity Range|
|---|---|
|None|0.0|
|Low|0.1-3.9|
|Medium|4.0-6.9|
|High|7.0-8.9|
|Critical|9.0-10.0|

The severity score is calculated according to metrics divided into three metric groups: base score metrics, temporal score metrics, and environmental score metrics.

![Metrics](docs/images/metrics.png)

I managed to narrow down the vulnerabilities to be processed to 156 pieces. I downloaded a report from GitLab in CSV format. After that, I separately downloaded a list of all vulnerabilities with CVE codes and their EPSS values from first.org. By combining these two pieces of information into one table, I was able to filter out all cases with EPSS values below 1. Based on this data, CVSS scores can still be examined separately and each case can be evaluated individually.

![[Pasted image 20250730152300.png]]
This diagram shows the current distribution of the vulnerabilities discovered from our PrestaShop base image. The x-axis maps CVSS-scores and y-axis maps EPSS-scores. Note, that only vulnerabilities with an EPSS probability score of 1% or more are included in the data. Of the over 4000 vulnerabilities discovered, majority (approx. 96%) would be located in the lower left corner, a finding that is very significant regarding our projects vulnerability management. The colors of the dots indicate GitLab labels for vulnerability severity level: darker blue dots are critical level, orange dots are high level, green dots are medium level, and lighter blue dots are low level vulnerabilities.

Now, we can compare the diagram above with the diagram below, depicting how to use the scores in vulnerability management. Keep in mind, that the majority of the findings would be positioned to the lower left corner - the area of deprioritization - with EPSS-scores under 1% and CVSS-scores under 2,0:

![[epss-v-cvss-5-16-thresh.png]]
## CWE - Common Weakness Enumeration
The combination CVSS, EPSS, and KEV is still not enough to cauge all of the vulnerabilities in our project. Vulnerability findings acquired through GitLab SAST-scanner - at least in the case of our PrestaShop code base - do not include CVSS or EPSS values. Thus it is not possible to use the same strategy to prioritize them as with vulnerabilities that can be filtered with those numbers. This is where Common Weakness Enumeration (CWE) comes handy.

CWE is a community developed list of common software and hardware weaknesses. Weakness means a condition of a system, that under certain circumstances, could contribute to the introduction of vulnerabilities. Thus CWE and its taxonomies and classifications operate as a language that can be used to identify and describe weaknesses, even if the sources of the weaknesses (i.e. code) are not identical. CWE uses a glossary of terminology derived from vulnerability theory.

Instances of weaknesses in CWE are related through a structure of a partially ordered set, where the weaknesses have "parent - child" relations. The parent nodes have a higher level of abstraction, whereas the child nodes are more technical or concrete in nature. There are four types of weakness abstractions: Pillar, Class, Base and Variant. The abstraction types correlate with the amount of specific information. Weakness Categories group together similar weaknesses with common characteristics.

### Use of CWE
The CWE can be used as a common language to discuss issues in a system. Also it is useful in VMF discovery, identification, assessment and mitigation phases. Thus CWE operates on a "deeper level" than for example CVE, since it addresses root causes of vulnerabilities instead of known vulnerabilities in commonly used resources (i.e. products) in information systems.

 Since the vulnerabilities identified by CWE do not have CVSS or EPSS and do not in themselves give us quantitative metrics, alternative resources are utilized: the SANS/CWE TOP 25 and CWE TOP 10 KEV -lists. The former lists 25 most common and impactful software weaknesses. It can also be supplemented with an "on the cusp" list - as we do - that has the vulnerabilities habiting positions 26-40. Finally, the TOP 10 KEV lists ten most actively exploited weaknesses. Combining these three sources of quantitative metrics with our results we are able to form clear priorities to the findings of SAST-scans.

## Misc
- All fuzz test results are reported as `unknown` and should be manually triaged.
- The GitLab secrets -scanner gives every finding a `critical` severity level and as such should always be investigated.

## PrestaScan
PrestaScan is a free application level security module. It can be integrated with PrestaShop Back Office. After integration it will run few scans on the PrestaShop itself. Few of the noteworthy here are:
- scanning installed modules for known vulnerabilities and update needs
- identifies unused modules
- lists the known vulnerabilities in the current PrestaShop version
- detects unprotected directories.

Running PrestaScan on our instance of PrestaShop produced moderate amount of findings. All the directories (except PrestaScan test directory) were protected. 4 modules were detected to be a possible vulnerability. Of those 3 just needed an update. The scanner was also able to find one unused module. Lastly the scanner identified 13 known core vulnerabilities of PrestaShop 1.7.8.0.

PrestaScan does not directly utilize KEV, CVSS or EPSS scores for the known vulnerabilities. It does give the results a severity descriptors similar to GitLab: critical, high, medium and low se there is some sense of priority in the results, but we need to know what is their position in our overall triage of vulnerabilities. The results also include some contextual information such as type of the vulnerability (SQL injection, XSS etc.), does the vulnerability affect front or back office and PrestaShop versions vulnerable to it which helps a bit. Fortunately, the results do include CVE-identifier and a link to NIST-database where CVSS-scores are available. With the CVE-identifier it also possible to find the EPSS-scores of all the findings and to check if they're listed in the Known Exploited Vulnerabilities (KEV) catalogue.

With the extra information explained above we can filter from the findings the vulnerabilities with an EPSS-score of above 1. There are 5 vulnerabilities that remain after this filtering. None of the findings are listed in KEV-catalogue.

## Assessment phase within DevLetics project
Looking at the above chart from the first.org EPSS-site we can see, that we should prioritize the vulnerabilities that have a known vulnerability, a CVSS-score of over 6 and an EPSS-score over 0,4. GitLab recommends that known vulnerabilities should allways be prioritized, so after this set all other vulnerabilities with a KEV should be prioritized. Third priority section are vulnerabilities without KEV, but CVSS-score above 6 and EPSS-score above 0,4. Next up after these are the vulnerabilities with high CVSS-scores, but EPSS-scores of under 0,4.

#### Base image first priorities
![[Pasted image 20250811151819.png]]
Using the logic described above, we get this table of vulnerabilities concerning our base image. 

#### Code
![[Pasted image 20250811153416.png]]
Results from our code repository where mainly from GitLab SAST-scanner and thus they do not have EPSS and CVSS-scores as discussed above. Instead we need to use the CWE top numbers and KEV top numbers to prioritize these weaknesses. Utilizing them to filter the results we get the table above.

#### Database
![[Pasted image 20250811153134.png]]
Curiously and also luckily the scanners found no vulnerabilities with a KEV within our database repository. This means that our main concern with vulnerability management with GitLab findings are with base image and code base.

#### PrestaScan
![[Pasted image 20250814142440.png]]
After narrowing down the results to only include result with an EPSS score of above 0,01, we get the table above. These all fall to the fourth tier of priority: vulnerabilities with no KEV, a high CVSS-score and EPSS under 0,4.
#### Further assessment
But how do we prioritize between base image vulnerabilities and code weaknesses? Remember, they are not assessed through equivalent criteria so our objective criterion to measure the priority levels breaks down here. Fortunately we don't necessarily have to sort items from these two lists in to a one unified task list, since within our project the issues concerning code base and base image would fall within different ranges of responsibility within the team. It is still necessary to communicate to the stakeholders that both of these lists contain threats that pose serious security risks if left unmitigated and resources should be allocated to mitigating them. If, for whatever reason (eg. short term money savings), stakeholders would still want to focus just one of these, the vulnerabilities found in the base image repository are quicker and less resources consuming to fix.  
## Resources
https://docs.gitlab.com/user/application_security/vulnerability_report/
https://docs.gitlab.com/user/application_security/triage/
https://docs.gitlab.com/user/application_security/vulnerabilities/risk_assessment_data/
https://docs.gitlab.com/user/application_security/vulnerabilities/severities/
https://www.sans.org/blog/the-vulnerability-assessment-framework
https://owasp.org/www-project-threat-and-safeguard-matrix/
https://www.cve.org/
https://www.first.org/epss/
https://www.sans.org/top25-software-errors
https://cwe.mitre.org/top25/
https://cwe.mitre.org/top25/archive/2024/2024_onthecusp_list.html
https://cwe.mitre.org/top25/archive/2024/2024_kev_list.html
